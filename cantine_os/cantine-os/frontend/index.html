<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ardoise - Moteur de Conformit√©</title>
    <meta name="description"
        content="Optimisez vos menus de restauration collective avec l'IA. Conformit√© Egalim, GEMRCN, Budget et Carbone.">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Merriweather:wght@300;400;700;900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div id="app">
        <!-- Mobile Overlay -->
        <div class="sidebar-overlay" onclick="closeSidebar()"></div>

        <!-- Sidebar Navigation -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <img src="assets/logo.png" alt="Ardoise" class="logo-image">
                    <span class="logo-text">Ardoise</span>
                </div>
                <button class="sidebar-toggle" onclick="toggleSidebar()" title="R√©duire le menu">
                    <span class="toggle-icon">‚óÄ</span>
                </button>
            </div>
            <nav class="sidebar-nav">

                <a href="#" class="nav-item active" data-view="dashboard">
                    <span class="nav-icon">üìä</span>
                    <span>Tableau de bord</span>
                </a>
                <a href="#" class="nav-item" data-view="generator" style="display: none;">
                    <span class="nav-icon">ü§ñ</span>
                    <span>G√©n√©rateur IA</span>
                </a>
                <a href="#" class="nav-item" data-view="ocr" style="display: none;">
                    <span class="nav-icon">üì∑</span>
                    <span>Scanner Menu (OCR)</span>
                </a>
                <a href="#" class="nav-item" data-view="heatmap" style="display: none;">
                    <span class="nav-icon">üî•</span>
                    <span>Heatmap Valeur</span>
                </a>
                <a href="#" class="nav-item" data-view="planning">
                    <span class="nav-icon">üìÖ</span>
                    <span>Planning</span>
                </a>
                <a href="#" class="nav-item" data-view="recipes">
                    <span class="nav-icon">üìñ</span>
                    <span>Base Recettes</span>
                </a>
                <a href="#" class="nav-item" data-view="suppliers">
                    <span class="nav-icon">üè™</span>
                    <span>Fournisseurs</span>
                </a>
                <a href="#" class="nav-item" data-view="stocks">
                    <span class="nav-icon">üì¶</span>
                    <span>Stocks</span>
                </a>
                <a href="#" class="nav-item" data-view="antigaspi">
                    <span class="nav-icon">‚ôªÔ∏è</span>
                    <span>Anti-Gaspi</span>
                </a>
                <a href="#" class="nav-item" data-view="etablissements">
                    <span class="nav-icon">üè´</span>
                    <span>√âtablissements</span>
                </a>
                <a href="#" class="nav-item" data-view="settings">
                    <span class="nav-icon">‚öôÔ∏è</span>
                    <span>Configuration</span>
                </a>
            </nav>
            <div class="sidebar-footer">
                <div class="compliance-badge">
                    <span class="badge-icon">‚úÖ</span>
                    <span>Egalim 2024</span>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard View -->
            <section id="view-dashboard" class="view active">
                <header class="view-header">
                    <button class="mobile-menu-toggle" onclick="toggleSidebar()">‚ò∞</button>
                    <div>
                        <h1>Tableau de Bord</h1>
                        <p class="subtitle">Vue d'ensemble de votre conformit√© alimentaire</p>
                    </div>
                    <div class="header-actions">
                        <button class="btn btn-primary" onclick="showView('generator')">
                            <span>ü§ñ</span> G√©n√©rer un Menu
                        </button>
                    </div>
                </header>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon green">üå±</div>
                        <div class="stat-content">
                            <span class="stat-value">20%</span>
                            <span class="stat-label">Repas V√©g√©tariens</span>
                        </div>
                        <div class="stat-trend positive">‚Üë Egalim OK</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon blue">üí∞</div>
                        <div class="stat-content">
                            <span class="stat-value">1.85‚Ç¨</span>
                            <span class="stat-label">Co√ªt Moyen / Repas</span>
                        </div>
                        <div class="stat-trend positive">‚Üì -8% vs budget</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon yellow">üåç</div>
                        <div class="stat-content">
                            <span class="stat-value">1.2kg</span>
                            <span class="stat-label">CO‚ÇÇ Moyen / Repas</span>
                        </div>
                        <div class="stat-trend positive">‚Üì -15% objectif</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon purple">üìç</div>
                        <div class="stat-content">
                            <span class="stat-value">65%</span>
                            <span class="stat-label">Produits Locaux</span>
                        </div>
                        <div class="stat-trend positive">‚Üë +12%</div>
                    </div>
                </div>

                <div class="dashboard-grid">
                    <div class="card">
                        <div class="card-header">
                            <h3>Conformit√© GEMRCN</h3>
                            <span class="badge success">100%</span>
                        </div>
                        <div class="progress-list">
                            <div class="progress-item">
                                <span>Crudit√©s (‚â•10/20)</span>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 100%"></div>
                                </div>
                                <span class="progress-value">12/20</span>
                            </div>
                            <div class="progress-item">
                                <span>Poisson qualit√© (‚â•4/20)</span>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 100%"></div>
                                </div>
                                <span class="progress-value">5/20</span>
                            </div>
                            <div class="progress-item">
                                <span>Fritures (‚â§4/20)</span>
                                <div class="progress-bar">
                                    <div class="progress-fill warning" style="width: 75%"></div>
                                </div>
                                <span class="progress-value">3/20</span>
                            </div>
                            <div class="progress-item">
                                <span>Fruits crus (‚â•8/20)</span>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 100%"></div>
                                </div>
                                <span class="progress-value">10/20</span>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h3>Menu de la Semaine</h3>
                            <a href="#" onclick="showView('generator'); return false;">Modifier ‚Üí</a>
                        </div>
                        <div class="week-preview" id="week-preview">
                            <!-- Filled by JS -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- Generator View -->
            <section id="view-generator" class="view">
                <header class="view-header">
                    <div>
                        <h1>ü§ñ G√©n√©rateur de Menus IA</h1>
                        <p class="subtitle">Laissez l'algorithme optimiser vos menus</p>
                    </div>
                </header>

                <div class="generator-layout">
                    <div class="config-panel">
                        <div class="card">
                            <div class="card-header">
                                <h3>‚öôÔ∏è Configuration</h3>
                            </div>
                            <form id="generator-form">
                                <div class="form-group">
                                    <label>Nom de l'√©tablissement</label>
                                    <input type="text" id="input-nom" value="√âcole Primaire Jean Moulin" required>
                                </div>

                                <div class="form-group">
                                    <label>üí∞ Budget Maximum par Repas (‚Ç¨)</label>
                                    <div class="range-input">
                                        <input type="range" id="input-budget" min="1.5" max="3" step="0.1" value="2.0">
                                        <span class="range-value" id="budget-value">2.00‚Ç¨</span>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label>üìÖ Nombre de Jours</label>
                                    <select id="input-jours">
                                        <option value="5">5 jours (1 semaine)</option>
                                        <option value="10">10 jours (2 semaines)</option>
                                        <option value="20" selected>20 jours (1 mois)</option>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label>üë∂ Profil des Convives</label>
                                    <div class="convive-selector">
                                        <div class="convive-option">
                                            <input type="checkbox" id="convive-maternelle" checked>
                                            <label for="convive-maternelle">Maternelle (3-6 ans)</label>
                                            <input type="number" id="effectif-maternelle" value="50" min="0">
                                        </div>
                                        <div class="convive-option">
                                            <input type="checkbox" id="convive-elementaire" checked>
                                            <label for="convive-elementaire">√âl√©mentaire (6-11 ans)</label>
                                            <input type="number" id="effectif-elementaire" value="150" min="0">
                                        </div>
                                        <div class="convive-option">
                                            <input type="checkbox" id="convive-ado">
                                            <label for="convive-ado">Adolescents (11-18 ans)</label>
                                            <input type="number" id="effectif-ado" value="0" min="0">
                                        </div>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label>üéØ Priorit√©s d'Optimisation</label>
                                    <div class="priority-sliders">
                                        <div class="priority-item">
                                            <span>üí∞ Budget</span>
                                            <input type="range" id="prio-budget" min="0" max="100" value="40">
                                        </div>
                                        <div class="priority-item">
                                            <span>üåç Carbone</span>
                                            <input type="range" id="prio-carbone" min="0" max="100" value="30">
                                        </div>
                                        <div class="priority-item">
                                            <span>üìç Local</span>
                                            <input type="range" id="prio-local" min="0" max="100" value="30">
                                        </div>
                                    </div>
                                </div>

                                <button type="submit" class="btn btn-primary btn-block">
                                    <span class="btn-icon">‚ú®</span>
                                    G√©n√©rer le Menu Optimis√©
                                </button>
                            </form>
                        </div>
                    </div>

                    <div class="result-panel">
                        <div class="card" id="result-card">
                            <div class="empty-state">
                                <div class="empty-icon">üçΩÔ∏è</div>
                                <h3>Pr√™t √† g√©n√©rer</h3>
                                <p>Configurez vos param√®tres et lancez le g√©n√©rateur IA</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- OCR Scanner View -->
            <section id="view-ocr" class="view">
                <header class="view-header">
                    <div>
                        <h1>üì∑ Scanner de Menu (OCR)</h1>
                        <p class="subtitle">Extrayez automatiquement le contenu d'un menu depuis une image ou un PDF</p>
                    </div>
                </header>

                <div class="ocr-layout">
                    <div class="upload-panel">
                        <div class="card">
                            <div class="card-header">
                                <h3>üì§ Importer un Menu</h3>
                                <span class="badge" id="ocr-model-badge">olmOCR-7B</span>
                            </div>
                            <div class="upload-zone" id="ocr-dropzone">
                                <div class="dropzone-content">
                                    <div class="dropzone-icon">üìÑ</div>
                                    <h4>Glissez-d√©posez votre fichier ici</h4>
                                    <p>ou cliquez pour s√©lectionner</p>
                                    <div class="dropzone-formats">
                                        Formats accept√©s: PDF, PNG, JPG, JPEG
                                    </div>
                                    <input type="file" id="ocr-file-input" accept=".pdf,.png,.jpg,.jpeg,.webp" hidden>
                                </div>
                            </div>
                            <div class="upload-actions">
                                <button class="btn btn-primary btn-block" id="ocr-scan-btn" disabled>
                                    <span class="btn-icon">üîç</span>
                                    Lancer l'extraction OCR
                                </button>
                            </div>
                            <div class="selected-file" id="selected-file-info" style="display: none;">
                                <span class="file-icon">üìé</span>
                                <span class="file-name" id="selected-file-name"></span>
                                <button class="btn-remove" onclick="clearOCRFile()">‚úï</button>
                            </div>
                        </div>
                    </div>

                    <div class="ocr-result-panel">
                        <div class="card" id="ocr-result-card">
                            <div class="empty-state">
                                <div class="empty-icon">üî¨</div>
                                <h3>En attente d'un fichier</h3>
                                <p>Le mod√®le <strong>olmOCR-7B</strong> (HuggingFace) analysera votre menu et extraira
                                    automatiquement les plats, prix et informations nutritionnelles.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Heatmap View -->
            <section id="view-heatmap" class="view">
                <header class="view-header">
                    <div>
                        <h1>üî• Heatmap Densit√© Nutritionnelle vs Co√ªt</h1>
                        <p class="subtitle">Prouvez aux d√©cideurs que la qualit√© ne co√ªte pas plus cher</p>
                    </div>
                </header>

                <div class="heatmap-container">
                    <div class="card">
                        <div class="card-header">
                            <h3>Valeur Nutritionnelle par Euro D√©pens√©</h3>
                            <div class="legend">
                                <span class="legend-item"><span class="dot green"></span> Excellent rapport</span>
                                <span class="legend-item"><span class="dot yellow"></span> Bon rapport</span>
                                <span class="legend-item"><span class="dot red"></span> Faible rapport</span>
                            </div>
                        </div>
                        <div class="heatmap-grid" id="heatmap-grid">
                            <!-- Filled by JS -->
                        </div>
                    </div>

                    <div class="card insight-card">
                        <div class="card-header">
                            <h3>üí° Insight Cl√©</h3>
                        </div>
                        <div class="insight-content">
                            <div class="insight-highlight">
                                <span class="highlight-value">2.4x</span>
                                <span class="highlight-label">Les lentilles offrent 2.4x plus de nutriments par euro que
                                    le poulet</span>
                            </div>
                            <p class="insight-description">
                                Cette analyse d√©montre que les prot√©ines v√©g√©tales (l√©gumineuses) sont non seulement
                                conformes √† la loi Egalim mais √©galement plus √©conomiques et plus denses
                                nutritionnellement
                                que les alternatives carn√©es.
                            </p>
                            <div class="insight-cta">
                                <button class="btn btn-outline" onclick="exportHeatmapPDF()">
                                    üìÑ Exporter pour pr√©sentation
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Planning View -->
            <section id="view-planning" class="view">
                <header class="view-header">
                    <div>
                        <h1>üìÖ Planning des Menus</h1>
                        <p class="subtitle" id="planning-week-label">Semaine 50 ‚Ä¢ 9 - 13 D√©cembre 2024</p>
                    </div>
                    <div class="header-actions">
                        <div class="week-navigation">
                            <button class="btn btn-icon" onclick="navigateWeek(-1)" title="Semaine pr√©c√©dente">
                                <span>‚óÄ</span>
                            </button>
                            <button class="btn btn-outline" onclick="goToCurrentWeek()">
                                <span>üìç</span> Aujourd'hui
                            </button>
                            <button class="btn btn-icon" onclick="navigateWeek(1)" title="Semaine suivante">
                                <span>‚ñ∂</span>
                            </button>
                        </div>
                        <button class="btn btn-primary" onclick="autoFillPlanning()">
                            <span>ü§ñ</span> Remplir avec IA
                        </button>
                    </div>
                </header>

                <div class="planning-layout">
                    <div class="planning-calendar">
                        <div class="planning-grid" id="planning-grid">
                            <!-- Header row -->
                            <div class="planning-header-row">
                                <div class="planning-type-label"></div>
                                <div class="planning-day-header" data-day="0">Lundi<br><span class="date-small"
                                        id="date-0"></span></div>
                                <div class="planning-day-header" data-day="1">Mardi<br><span class="date-small"
                                        id="date-1"></span></div>
                                <div class="planning-day-header" data-day="2">Mercredi<br><span class="date-small"
                                        id="date-2"></span></div>
                                <div class="planning-day-header" data-day="3">Jeudi<br><span class="date-small"
                                        id="date-3"></span></div>
                                <div class="planning-day-header" data-day="4">Vendredi<br><span class="date-small"
                                        id="date-4"></span></div>
                            </div>

                            <!-- Entr√©e row -->
                            <div class="planning-row" data-type="entree">
                                <div class="planning-type-label">ü•ó Entr√©e</div>
                                <div class="planning-slot" data-day="0" data-type="entree"
                                    onclick="openRecipeSelector(0, 'entree')"></div>
                                <div class="planning-slot" data-day="1" data-type="entree"
                                    onclick="openRecipeSelector(1, 'entree')"></div>
                                <div class="planning-slot" data-day="2" data-type="entree"
                                    onclick="openRecipeSelector(2, 'entree')"></div>
                                <div class="planning-slot" data-day="3" data-type="entree"
                                    onclick="openRecipeSelector(3, 'entree')"></div>
                                <div class="planning-slot" data-day="4" data-type="entree"
                                    onclick="openRecipeSelector(4, 'entree')"></div>
                            </div>

                            <!-- Plat principal row -->
                            <div class="planning-row" data-type="plat_principal">
                                <div class="planning-type-label">üçñ Plat Principal</div>
                                <div class="planning-slot" data-day="0" data-type="plat_principal"
                                    onclick="openRecipeSelector(0, 'plat_principal')"></div>
                                <div class="planning-slot" data-day="1" data-type="plat_principal"
                                    onclick="openRecipeSelector(1, 'plat_principal')"></div>
                                <div class="planning-slot" data-day="2" data-type="plat_principal"
                                    onclick="openRecipeSelector(2, 'plat_principal')"></div>
                                <div class="planning-slot" data-day="3" data-type="plat_principal"
                                    onclick="openRecipeSelector(3, 'plat_principal')"></div>
                                <div class="planning-slot" data-day="4" data-type="plat_principal"
                                    onclick="openRecipeSelector(4, 'plat_principal')"></div>
                            </div>

                            <!-- Garniture row -->
                            <div class="planning-row" data-type="garniture">
                                <div class="planning-type-label">ü•î Garniture</div>
                                <div class="planning-slot" data-day="0" data-type="garniture"
                                    onclick="openRecipeSelector(0, 'garniture')"></div>
                                <div class="planning-slot" data-day="1" data-type="garniture"
                                    onclick="openRecipeSelector(1, 'garniture')"></div>
                                <div class="planning-slot" data-day="2" data-type="garniture"
                                    onclick="openRecipeSelector(2, 'garniture')"></div>
                                <div class="planning-slot" data-day="3" data-type="garniture"
                                    onclick="openRecipeSelector(3, 'garniture')"></div>
                                <div class="planning-slot" data-day="4" data-type="garniture"
                                    onclick="openRecipeSelector(4, 'garniture')"></div>
                            </div>

                            <!-- Dessert row -->
                            <div class="planning-row" data-type="dessert">
                                <div class="planning-type-label">üç® Dessert</div>
                                <div class="planning-slot" data-day="0" data-type="dessert"
                                    onclick="openRecipeSelector(0, 'dessert')"></div>
                                <div class="planning-slot" data-day="1" data-type="dessert"
                                    onclick="openRecipeSelector(1, 'dessert')"></div>
                                <div class="planning-slot" data-day="2" data-type="dessert"
                                    onclick="openRecipeSelector(2, 'dessert')"></div>
                                <div class="planning-slot" data-day="3" data-type="dessert"
                                    onclick="openRecipeSelector(3, 'dessert')"></div>
                                <div class="planning-slot" data-day="4" data-type="dessert"
                                    onclick="openRecipeSelector(4, 'dessert')"></div>
                            </div>

                            <!-- Produit laitier row -->
                            <div class="planning-row" data-type="produit_laitier">
                                <div class="planning-type-label">üßÄ Laitage</div>
                                <div class="planning-slot" data-day="0" data-type="produit_laitier"
                                    onclick="openRecipeSelector(0, 'produit_laitier')"></div>
                                <div class="planning-slot" data-day="1" data-type="produit_laitier"
                                    onclick="openRecipeSelector(1, 'produit_laitier')"></div>
                                <div class="planning-slot" data-day="2" data-type="produit_laitier"
                                    onclick="openRecipeSelector(2, 'produit_laitier')"></div>
                                <div class="planning-slot" data-day="3" data-type="produit_laitier"
                                    onclick="openRecipeSelector(3, 'produit_laitier')"></div>
                                <div class="planning-slot" data-day="4" data-type="produit_laitier"
                                    onclick="openRecipeSelector(4, 'produit_laitier')"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Sidebar de conformit√© -->
                    <div class="planning-sidebar">
                        <div class="card compliance-card">
                            <div class="card-header">
                                <h3>üìä Synth√®se Semaine</h3>
                            </div>
                            <div class="compliance-stats" id="planning-compliance-stats">
                                <div class="compliance-item">
                                    <span class="compliance-label">üå± Repas V√©g√©tariens</span>
                                    <div class="compliance-bar">
                                        <div class="compliance-fill" id="compliance-veg" style="width: 0%"></div>
                                    </div>
                                    <span class="compliance-value" id="compliance-veg-value">0/1</span>
                                </div>
                                <div class="compliance-item">
                                    <span class="compliance-label">üåø Produits Bio</span>
                                    <div class="compliance-bar">
                                        <div class="compliance-fill" id="compliance-bio" style="width: 0%"></div>
                                    </div>
                                    <span class="compliance-value" id="compliance-bio-value">0%</span>
                                </div>
                                <div class="compliance-item">
                                    <span class="compliance-label">üìç Produits Locaux</span>
                                    <div class="compliance-bar">
                                        <div class="compliance-fill" id="compliance-local" style="width: 0%"></div>
                                    </div>
                                    <span class="compliance-value" id="compliance-local-value">0%</span>
                                </div>
                                <div class="compliance-divider"></div>
                                <div class="compliance-item large">
                                    <span class="compliance-label">üí∞ Co√ªt Moyen / Jour</span>
                                    <span class="compliance-value large" id="compliance-cost-value">0.00‚Ç¨</span>
                                </div>
                                <div class="compliance-item large">
                                    <span class="compliance-label">üåç CO‚ÇÇ Moyen / Jour</span>
                                    <span class="compliance-value large" id="compliance-co2-value">0.00kg</span>
                                </div>
                            </div>
                        </div>

                        <!-- Anti-Gaspi Panel -->
                        <div class="card antigaspi-card" id="antigaspi-card">
                            <div class="card-header antigaspi-header" onclick="toggleAntiGaspiPanel()">
                                <h3>‚ôªÔ∏è Anti-Gaspi</h3>
                                <span class="antigaspi-score" id="antigaspi-score">--</span>
                                <span class="collapse-icon" id="antigaspi-collapse-icon">‚ñº</span>
                            </div>
                            <div class="antigaspi-content" id="antigaspi-content">
                                <!-- D√©chets valorisables -->
                                <div class="waste-summary" id="waste-summary">
                                    <div class="waste-empty">
                                        <span>üìä</span>
                                        <p>Ajoutez des recettes au planning pour voir les d√©chets valorisables</p>
                                    </div>
                                </div>

                                <!-- Suggestions de recettes -->
                                <div class="waste-suggestions" id="waste-suggestions" style="display: none;">
                                    <h4>üí° Valorisation possible</h4>
                                    <div class="suggestions-list" id="suggestions-list">
                                        <!-- Filled by JS -->
                                    </div>
                                </div>

                                <!-- Stats √©conomiques -->
                                <div class="antigaspi-stats" id="antigaspi-stats" style="display: none;">
                                    <div class="antigaspi-stat">
                                        <span class="stat-icon">üåç</span>
                                        <span class="stat-label">CO‚ÇÇ √©vit√©</span>
                                        <span class="stat-value" id="co2-evite">0 kg</span>
                                    </div>
                                    <div class="antigaspi-stat">
                                        <span class="stat-icon">üí∞</span>
                                        <span class="stat-label">√âconomies</span>
                                        <span class="stat-value" id="economie-estimee">0 ‚Ç¨</span>
                                    </div>
                                </div>

                                <!-- AI Suggestions Button -->
                                <div class="ai-suggestions-action" id="ai-suggestions-action" style="display: none;">
                                    <button class="btn btn-primary btn-block btn-ai"
                                        onclick="getAIAntiGaspiSuggestions()">
                                        <span>ü§ñ</span> Demander √† l'IA
                                    </button>
                                </div>

                                <!-- AI Suggestions Results -->
                                <div class="ai-suggestions-results" id="ai-suggestions-results" style="display: none;">
                                    <h4>ü§ñ Conseils IA</h4>
                                    <div class="ai-conseil-general" id="ai-conseil-general"></div>
                                    <div class="ai-suggestions-list" id="ai-suggestions-list"></div>
                                </div>
                            </div>
                        </div>

                        <div class="planning-actions">
                            <button class="btn btn-outline btn-block" onclick="clearPlanning()">
                                <span>üóëÔ∏è</span> Vider la semaine
                            </button>
                            <button class="btn btn-outline btn-block" onclick="duplicatePreviousWeek()">
                                <span>üìã</span> Copier semaine pr√©c√©dente
                            </button>
                            <div class="export-dropdown">
                                <button class="btn btn-primary btn-block export-dropdown-toggle">
                                    <span>üì•</span> Exporter <span class="dropdown-arrow">‚ñº</span>
                                </button>
                                <div class="dropdown-menu">
                                    <button type="button" onclick="exportPlanningPDF()">üìÑ Planning PDF</button>
                                    <button type="button" onclick="exportPlanningCSV()">üìä Planning CSV</button>
                                    <button type="button" onclick="openRecipeSheetModal()">üç≥ Fiches Recettes</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Recipe Selector Modal for Planning -->
            <div class="modal" id="recipe-selector-modal">
                <div class="modal-content modal-large">
                    <div class="modal-header">
                        <h3 id="recipe-selector-title">S√©lectionner une recette</h3>
                        <button class="modal-close" onclick="closeRecipeSelector()">&times;</button>
                    </div>
                    <div class="recipe-selector-filters">
                        <input type="search" placeholder="Rechercher..." id="recipe-selector-search"
                            oninput="filterRecipeSelector()">
                        <label class="checkbox-label">
                            <input type="checkbox" id="selector-filter-veg" onchange="filterRecipeSelector()"> üå±
                            V√©g√©tarien
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="selector-filter-bio" onchange="filterRecipeSelector()"> üåø Bio
                        </label>
                    </div>
                    <div class="recipe-selector-grid" id="recipe-selector-grid">
                        <!-- Filled by JS -->
                    </div>
                </div>
            </div>

            <!-- Recipe Sheet Modal -->
            <div class="modal" id="recipe-sheet-modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>üç≥ Fiches Recettes Cuisine</h3>
                        <button class="modal-close" onclick="closeRecipeSheetModal()">&times;</button>
                    </div>
                    <div class="recipe-sheet-info">
                        <p>G√©n√©rez des fiches recettes imprimables pour la cuisine avec les quantit√©s d'ingr√©dients
                            adapt√©es au nombre de convives.</p>
                    </div>
                    <form id="recipe-sheet-form" onsubmit="generateRecipeSheets(event)">
                        <div class="form-group">
                            <label>Nombre de repas √† pr√©parer</label>
                            <input type="number" id="meal-count-input" value="200" min="1" max="5000" required>
                            <span class="form-hint">Les quantit√©s d'ingr√©dients seront multipli√©es par ce nombre</span>
                        </div>
                        <div class="modal-actions">
                            <button type="button" class="btn btn-outline"
                                onclick="closeRecipeSheetModal()">Annuler</button>
                            <button type="submit" class="btn btn-primary">üìÑ G√©n√©rer les fiches</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Recipes View -->
            <section id="view-recipes" class="view">
                <header class="view-header">
                    <div>
                        <h1>üìñ Base de Recettes</h1>
                        <p class="subtitle">G√©rez votre catalogue de recettes</p>
                    </div>
                    <div class="header-actions">
                        <button class="btn btn-outline">
                            <span>üì§</span> Importer CSV
                        </button>
                        <button class="btn btn-primary">
                            <span>‚ûï</span> Nouvelle Recette
                        </button>
                    </div>
                </header>

                <div class="filters-bar">
                    <input type="search" placeholder="Rechercher une recette..." class="search-input"
                        id="recipe-search">
                    <select id="filter-type">
                        <option value="">Tous les types</option>
                        <option value="entree">Entr√©es</option>
                        <option value="plat_principal">Plats principaux</option>
                        <option value="garniture">Garnitures</option>
                        <option value="dessert">Desserts</option>
                        <option value="produit_laitier">Produits laitiers</option>
                    </select>
                    <label class="checkbox-label">
                        <input type="checkbox" id="filter-veg"> üå± V√©g√©tarien
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="filter-bio"> üåø Bio
                    </label>
                </div>

                <div class="recipes-grid" id="recipes-grid">
                    <!-- Filled by JS -->
                </div>
            </section>

            <!-- Suppliers View -->
            <section id="view-suppliers" class="view">
                <header class="view-header">
                    <div>
                        <h1>üè™ Fournisseurs</h1>
                        <p class="subtitle">G√©rez votre r√©seau de fournisseurs et leur catalogue de produits</p>
                    </div>
                    <div class="header-actions">
                        <button class="btn btn-outline" onclick="openImportModal()">
                            <span>üì•</span> Importer Produits
                        </button>
                        <button class="btn btn-primary" onclick="openSupplierModal()">
                            <span>‚ûï</span> Ajouter un Fournisseur
                        </button>
                    </div>
                </header>

                <div class="suppliers-stats" id="suppliers-stats">
                    <!-- Filled by JS -->
                </div>

                <div class="suppliers-grid" id="suppliers-grid">
                    <!-- Filled by JS -->
                </div>
            </section>

            <!-- Stocks View -->
            <section id="view-stocks" class="view">
                <header class="view-header">
                    <div>
                        <h1>üì¶ Gestion des Stocks</h1>
                        <p class="subtitle">Suivez votre inventaire et anticipez vos commandes</p>
                    </div>
                    <div class="header-actions">
                        <button class="btn btn-outline" onclick="fetchStockAlerts()">
                            <span>üîî</span> Alertes
                            <span class="badge warning" id="alerts-count">0</span>
                        </button>
                        <button class="btn btn-outline" onclick="openScanModal()">
                            <span>üì∑</span> Scanner
                        </button>
                        <button class="btn btn-primary" onclick="openStockModal()">
                            <span>‚ûï</span> Ajouter un Stock
                        </button>
                    </div>
                </header>

                <div class="stocks-layout">
                    <!-- Alertes Panel -->
                    <div class="alerts-panel" id="stock-alerts-panel">
                        <div class="card alerts-card">
                            <div class="card-header">
                                <h3>üîî Alertes Stock</h3>
                            </div>
                            <div class="alerts-list" id="alerts-list">
                                <div class="empty-state small">
                                    <span>‚úÖ</span>
                                    <p>Aucune alerte</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tableau des stocks -->
                    <div class="stocks-table-container">
                        <div class="filters-bar">
                            <input type="search" placeholder="Rechercher un produit..." class="search-input"
                                id="stock-search" oninput="filterStocks()">
                            <select id="stock-filter-category" onchange="filterStocks()">
                                <option value="">Toutes cat√©gories</option>
                                <option value="legumes">L√©gumes</option>
                                <option value="legumineuses">L√©gumineuses</option>
                                <option value="viande">Viande</option>
                                <option value="produit_laitier">Produits laitiers</option>
                                <option value="feculents">F√©culents</option>
                                <option value="epicerie">√âpicerie</option>
                                <option value="oeufs">≈íufs</option>
                            </select>
                            <select id="stock-filter-status" onchange="filterStocks()">
                                <option value="">Tous les statuts</option>
                                <option value="ok">‚úÖ OK</option>
                                <option value="bas">‚ö†Ô∏è Bas</option>
                                <option value="rupture">üö® Rupture</option>
                            </select>
                        </div>

                        <div class="card">
                            <div class="table-container">
                                <table class="data-table" id="stocks-table">
                                    <thead>
                                        <tr>
                                            <th>Produit</th>
                                            <th>Cat√©gorie</th>
                                            <th>Quantit√©</th>
                                            <th>Min.</th>
                                            <th>Statut</th>
                                            <th>Emplacement</th>
                                            <th>DLC</th>
                                            <th>Fournisseur</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="stocks-tbody">
                                        <!-- Filled by JS -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Besoins Section -->
                <div class="needs-section">
                    <div class="card">
                        <div class="card-header">
                            <h3>üìä Besoins vs Stock (Semaine courante)</h3>
                            <button class="btn btn-outline btn-sm" onclick="calculateNeeds()">
                                <span>üîÑ</span> Actualiser
                            </button>
                        </div>
                        <div class="needs-grid" id="needs-grid">
                            <div class="empty-state small">
                                <span>üìä</span>
                                <p>Cliquez sur "Actualiser" pour calculer les besoins</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Stock Add/Edit Modal -->
            <div class="modal" id="stock-modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 id="stock-modal-title">‚ûï Ajouter un Stock</h3>
                        <button class="modal-close" onclick="closeStockModal()">&times;</button>
                    </div>
                    <form id="stock-form" onsubmit="saveStock(event)">
                        <input type="hidden" id="stock-id">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Nom du produit *</label>
                                <input type="text" id="stock-produit-nom" required>
                            </div>
                            <div class="form-group">
                                <label>Cat√©gorie</label>
                                <select id="stock-categorie">
                                    <option value="">-- S√©lectionner --</option>
                                    <option value="legumes">L√©gumes</option>
                                    <option value="legumineuses">L√©gumineuses</option>
                                    <option value="viande">Viande</option>
                                    <option value="produit_laitier">Produits laitiers</option>
                                    <option value="feculents">F√©culents</option>
                                    <option value="epicerie">√âpicerie</option>
                                    <option value="oeufs">≈íufs</option>
                                    <option value="poisson">Poisson</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Quantit√© actuelle *</label>
                                <input type="number" id="stock-quantite" step="0.01" min="0" required>
                            </div>
                            <div class="form-group">
                                <label>Unit√© *</label>
                                <select id="stock-unite" required>
                                    <option value="kg">kg</option>
                                    <option value="litre">litre</option>
                                    <option value="unite">unit√©</option>
                                    <option value="douzaine">douzaine</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Seuil minimum</label>
                                <input type="number" id="stock-quantite-min" step="0.01" min="0" value="0">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Emplacement</label>
                                <select id="stock-emplacement">
                                    <option value="">-- S√©lectionner --</option>
                                    <option value="R√©serve s√®che">R√©serve s√®che</option>
                                    <option value="Chambre froide">Chambre froide</option>
                                    <option value="Chambre froide n√©gative">Chambre froide n√©gative</option>
                                    <option value="Cuisine">Cuisine</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>DLC</label>
                                <input type="date" id="stock-dlc">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Fournisseur</label>
                                <input type="text" id="stock-fournisseur-nom" placeholder="Nom du fournisseur">
                            </div>
                        </div>
                        <div class="modal-actions">
                            <button type="button" class="btn btn-outline" onclick="closeStockModal()">Annuler</button>
                            <button type="submit" class="btn btn-primary">üíæ Enregistrer</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Stock Movement Modal -->
            <div class="modal" id="movement-modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>üì¶ Mouvement de Stock</h3>
                        <button class="modal-close" onclick="closeMovementModal()">&times;</button>
                    </div>
                    <div class="movement-stock-info" id="movement-stock-info">
                        <!-- Filled by JS -->
                    </div>
                    <form id="movement-form" onsubmit="recordMovement(event)">
                        <input type="hidden" id="movement-stock-id">
                        <div class="form-group">
                            <label>Type de mouvement *</label>
                            <div class="movement-type-selector">
                                <label class="radio-card">
                                    <input type="radio" name="movement-type" value="entree" required>
                                    <span class="radio-card-content entree">
                                        <span class="icon">üì•</span>
                                        <span>Entr√©e</span>
                                    </span>
                                </label>
                                <label class="radio-card">
                                    <input type="radio" name="movement-type" value="sortie" required>
                                    <span class="radio-card-content sortie">
                                        <span class="icon">üì§</span>
                                        <span>Sortie</span>
                                    </span>
                                </label>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Quantit√© *</label>
                                <input type="number" id="movement-quantite" step="0.01" min="0.01" required>
                            </div>
                            <div class="form-group">
                                <label>Motif</label>
                                <select id="movement-motif">
                                    <option value="Pr√©paration menu">Pr√©paration menu</option>
                                    <option value="Livraison fournisseur">Livraison fournisseur</option>
                                    <option value="Inventaire correction">Inventaire correction</option>
                                    <option value="Perte / P√©remption">Perte / P√©remption</option>
                                    <option value="Autre">Autre</option>
                                </select>
                            </div>
                        </div>
                        <div class="modal-actions">
                            <button type="button" class="btn btn-outline"
                                onclick="closeMovementModal()">Annuler</button>
                            <button type="submit" class="btn btn-primary">‚úÖ Enregistrer</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Scan Product Modal -->
            <div id="scan-modal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>üì∑ Scanner un Produit</h3>
                        <button class="modal-close" onclick="closeScanModal()">&times;</button>
                    </div>
                    <div class="scan-container">
                        <div class="upload-area" id="scan-drop-area"
                            onclick="document.getElementById('scan-file-input').click()">
                            <span class="upload-icon">üì∏</span>
                            <p>Cliquez pour prendre une photo ou choisir un fichier</p>
                            <input type="file" id="scan-file-input" accept="image/*" style="display: none"
                                onchange="handleScanUpload(event)">
                        </div>
                        <div id="scan-preview" class="scan-preview hidden">
                            <img id="scan-image-preview" src="" alt="Aper√ßu">
                            <div class="scan-loading hidden" id="scan-loading">
                                <div class="spinner"></div>
                                <span>Analyse avec Gemini Vision...</span>
                            </div>
                        </div>
                        <div class="scan-instructions">
                            <p>Gemini d√©tectera automatiquement :</p>
                            <ul>
                                <li>‚ú® Nom du produit</li>
                                <li>üìÖ DLC / Date p√©remption</li>
                                <li>üì¶ Quantit√© et unit√©</li>
                                <li>üè∑Ô∏è Cat√©gorie</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Etablissements View -->
            <section id="view-etablissements" class="view">
                <header class="view-header">
                    <div>
                        <h1>üè´ Gestion des √âtablissements</h1>
                        <p class="subtitle">Configurez vos cantines et mutualisez vos commandes</p>
                    </div>
                    <div class="header-actions">
                        <div class="tabs-actions">
                            <button class="btn btn-tab active" onclick="switchEtabTab('list')">Liste</button>
                            <button class="btn btn-tab" onclick="switchEtabTab('bulk')">üì¶ Commandes Group√©es</button>
                        </div>
                        <button class="btn btn-primary" onclick="openEtablissementModal()">
                            <span>‚ûï</span> Nouvel √âtablissement
                        </button>
                    </div>
                </header>

                <!-- Tab: Liste -->
                <div id="etab-tab-list" class="etab-tab-content active">
                    <div class="etablissements-grid" id="etablissements-grid">
                        <!-- Filled by JS -->
                        <div class="card etablissement-card shimmer"></div>
                    </div>
                </div>

                <!-- Tab: Commandes Group√©es -->
                <div id="etab-tab-bulk" class="etab-tab-content" style="display: none;">
                    <div class="card">
                        <div class="card-header">
                            <h3>üì¶ Besoins Agr√©g√©s (Semaine 50)</h3>
                            <div class="header-actions">
                                <span class="badge info">4 √âtablissements</span>
                                <button class="btn btn-primary btn-sm" onclick="exportBonDeCommande()">
                                    üì• Exporter Bons de Commande
                                </button>
                            </div>
                        </div>
                        <div class="table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Ingr√©dient</th>
                                        <th>Quantit√© Totale</th>
                                        <th>√âtablissements</th>
                                        <th>Fournisseur Recommand√©</th>
                                        <th>Prix / Unit√©</th>
                                        <th>√âconomie</th>
                                    </tr>
                                </thead>
                                <tbody id="bulk-orders-body">
                                    <!-- Filled by JS -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Import Supplier Products Modal -->
            <div class="modal" id="import-supplier-modal">
                <div class="modal-content modal-large">
                    <div class="modal-header">
                        <h3>üì• Importer des Produits</h3>
                        <button class="modal-close" onclick="closeImportModal()">&times;</button>
                    </div>

                    <!-- Tabs -->
                    <div class="import-tabs">
                        <button class="import-tab active" data-tab="csv" onclick="switchImportTab('csv')">
                            üìÑ Fichier CSV
                        </button>
                        <button class="import-tab" data-tab="ocr" onclick="switchImportTab('ocr')">
                            üì∑ Scan (OCR)
                        </button>
                    </div>

                    <!-- CSV Tab Content -->
                    <div class="import-tab-content active" id="import-tab-csv">
                        <div class="import-dropzone" id="csv-dropzone">
                            <div class="dropzone-content">
                                <div class="dropzone-icon">üìÑ</div>
                                <h4>Glissez-d√©posez votre fichier CSV</h4>
                                <p>ou cliquez pour s√©lectionner</p>
                                <div class="dropzone-formats">
                                    Format: nom, categorie, unite, prix_unitaire, bio, origine
                                </div>
                                <input type="file" id="csv-file-input" accept=".csv" hidden>
                            </div>
                        </div>
                        <div class="import-file-info" id="csv-file-info" style="display: none;">
                            <span class="file-icon">üìé</span>
                            <span class="file-name" id="csv-file-name"></span>
                            <button class="btn-remove" onclick="clearImportFile('csv')">‚úï</button>
                        </div>
                    </div>

                    <!-- OCR Tab Content -->
                    <div class="import-tab-content" id="import-tab-ocr">
                        <div class="import-dropzone" id="ocr-supplier-dropzone">
                            <div class="dropzone-content">
                                <div class="dropzone-icon">üì∑</div>
                                <h4>Glissez-d√©posez une image</h4>
                                <p>Facture, catalogue, ou liste de prix</p>
                                <div class="dropzone-formats">
                                    Formats accept√©s: PNG, JPG, JPEG, WebP
                                </div>
                                <input type="file" id="ocr-supplier-file-input" accept=".png,.jpg,.jpeg,.webp" hidden>
                            </div>
                        </div>
                        <div class="import-file-info" id="ocr-supplier-file-info" style="display: none;">
                            <span class="file-icon">üìé</span>
                            <span class="file-name" id="ocr-supplier-file-name"></span>
                            <button class="btn-remove" onclick="clearImportFile('ocr')">‚úï</button>
                        </div>
                    </div>

                    <!-- Supplier Selector -->
                    <div class="import-supplier-selector">
                        <label>Ajouter les produits au fournisseur:</label>
                        <select id="import-supplier-select">
                            <option value="">-- S√©lectionner un fournisseur --</option>
                            <!-- Filled by JS -->
                        </select>
                        <span class="import-or">ou</span>
                        <button class="btn btn-outline btn-sm" onclick="closeImportModal(); openSupplierModal();">
                            ‚ûï Nouveau fournisseur
                        </button>
                    </div>

                    <!-- Preview Section -->
                    <div class="import-preview" id="import-preview" style="display: none;">
                        <h4>üìã Aper√ßu des produits</h4>
                        <div class="import-preview-stats" id="import-preview-stats"></div>
                        <div class="import-preview-table-wrapper">
                            <table class="import-preview-table">
                                <thead>
                                    <tr>
                                        <th>Nom</th>
                                        <th>Cat√©gorie</th>
                                        <th>Prix</th>
                                        <th>Unit√©</th>
                                        <th>Bio</th>
                                        <th>Origine</th>
                                    </tr>
                                </thead>
                                <tbody id="import-preview-body">
                                    <!-- Filled by JS -->
                                </tbody>
                            </table>
                        </div>
                        <div class="import-errors" id="import-errors" style="display: none;"></div>
                    </div>

                    <!-- Actions -->
                    <div class="modal-actions">
                        <button type="button" class="btn btn-outline" onclick="closeImportModal()">Annuler</button>
                        <button type="button" class="btn btn-primary" id="import-scan-btn" onclick="handleImportScan()">
                            üîç Analyser
                        </button>
                        <button type="button" class="btn btn-primary" id="import-confirm-btn" onclick="confirmImport()"
                            style="display: none;">
                            ‚úÖ Importer les produits
                        </button>
                    </div>
                </div>
            </div>

            <!-- Supplier Modal -->
            <div class="modal" id="supplier-modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 id="supplier-modal-title">Ajouter un Fournisseur</h3>
                        <button class="modal-close" onclick="closeSupplierModal()">&times;</button>
                    </div>
                    <form id="supplier-form" onsubmit="saveSupplier(event)">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Nom du fournisseur *</label>
                                <input type="text" id="supplier-nom" required>
                            </div>
                            <div class="form-group">
                                <label>Type</label>
                                <select id="supplier-type">
                                    <option value="producteur">Producteur</option>
                                    <option value="grossiste">Grossiste</option>
                                    <option value="cooperative">Coop√©rative</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Email</label>
                                <input type="email" id="supplier-email">
                            </div>
                            <div class="form-group">
                                <label>T√©l√©phone</label>
                                <input type="tel" id="supplier-telephone">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Ville</label>
                                <input type="text" id="supplier-ville">
                            </div>
                            <div class="form-group">
                                <label>Distance (km)</label>
                                <input type="number" id="supplier-distance" min="0" step="1">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Labels (s√©par√©s par virgule)</label>
                            <input type="text" id="supplier-labels" placeholder="bio, local, HVE...">
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>D√©lai livraison (jours)</label>
                                <input type="number" id="supplier-delai" min="1" value="1">
                            </div>
                            <div class="form-group">
                                <label>Minimum commande (‚Ç¨)</label>
                                <input type="number" id="supplier-minimum" min="0" step="10" value="0">
                            </div>
                        </div>
                        <input type="hidden" id="supplier-id">
                        <div class="modal-actions">
                            <button type="button" class="btn btn-outline"
                                onclick="closeSupplierModal()">Annuler</button>
                            <button type="submit" class="btn btn-primary">Enregistrer</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Product Detail Modal -->
            <div class="modal" id="product-modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 id="product-modal-title">Catalogue Produits</h3>
                        <button class="modal-close" onclick="closeProductModal()">&times;</button>
                    </div>
                    <div class="product-list" id="product-list">
                        <!-- Filled by JS -->
                    </div>
                </div>
            </div>

            <!-- Settings View -->
            <section id="view-settings" class="view">
                <header class="view-header">
                    <div>
                        <h1>‚öôÔ∏è Configuration</h1>
                        <p class="subtitle">Param√®tres de votre √©tablissement</p>
                    </div>
                </header>

                <div class="settings-grid">
                    <div class="card">
                        <div class="card-header">
                            <h3>üè´ √âtablissement</h3>
                        </div>
                        <form class="settings-form">
                            <div class="form-group">
                                <label>Nom</label>
                                <input type="text" value="√âcole Primaire Jean Moulin">
                            </div>
                            <div class="form-group">
                                <label>Type</label>
                                <select>
                                    <option>√âcole Maternelle</option>
                                    <option selected>√âcole √âl√©mentaire</option>
                                    <option>Coll√®ge</option>
                                    <option>Lyc√©e</option>
                                    <option>H√¥pital</option>
                                    <option>EHPAD</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Nombre de couverts/jour</label>
                                <input type="number" value="200">
                            </div>
                        </form>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h3>üìä Objectifs R√©glementaires</h3>
                        </div>
                        <div class="objectives-list">
                            <div class="objective-item">
                                <div class="objective-info">
                                    <span class="objective-name">Loi Egalim - Repas V√©g√©tariens</span>
                                    <span class="objective-value">‚â•1 par semaine</span>
                                </div>
                                <span class="status-badge success">Activ√©</span>
                            </div>
                            <div class="objective-item">
                                <div class="objective-info">
                                    <span class="objective-name">Produits Bio</span>
                                    <span class="objective-value">‚â•20%</span>
                                </div>
                                <span class="status-badge success">Activ√©</span>
                            </div>
                            <div class="objective-item">
                                <div class="objective-info">
                                    <span class="objective-name">Produits Durables</span>
                                    <span class="objective-value">‚â•50%</span>
                                </div>
                                <span class="status-badge success">Activ√©</span>
                            </div>
                            <div class="objective-item future">
                                <div class="objective-info">
                                    <span class="objective-name">Transition Prot√©ique 2050</span>
                                    <span class="objective-value">60% prot√©ines v√©g√©tales</span>
                                </div>
                                <span class="status-badge warning">B√™ta</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Anti-Gaspi View -->
            <section id="view-antigaspi" class="view">
                <header class="view-header">
                    <div>
                        <h1>‚ôªÔ∏è Anti-Gaspi</h1>
                        <p class="subtitle">Valorisation des d√©chets alimentaires</p>
                    </div>
                    <div class="header-actions">
                        <div class="antigaspi-score-large" id="antigaspi-score-main">
                            <span class="score-value">--</span>
                            <span class="score-label">Score valorisation</span>
                        </div>
                        <button class="btn btn-primary" onclick="getAIAntiGaspiSuggestions()">
                            <span>ü§ñ</span> Analyser avec IA
                        </button>
                    </div>
                </header>

                <div class="antigaspi-layout">
                    <!-- Left Column: Waste & AI -->
                    <div class="antigaspi-column">
                        <!-- Waste Summary Card -->
                        <div class="card antigaspi-waste-card">
                            <div class="card-header">
                                <h3>üóëÔ∏è D√©chets G√©n√©r√©s</h3>
                                <span class="week-label" id="antigaspi-week-label">Semaine 50</span>
                            </div>
                            <div class="card-content" id="antigaspi-waste-list">
                                <div class="waste-empty-large">
                                    <span>üìã</span>
                                    <p>Ajoutez des recettes au planning pour voir les d√©chets g√©n√©r√©s</p>
                                    <a href="#" onclick="showView('planning'); return false;">‚Üí Aller au Planning</a>
                                </div>
                            </div>
                        </div>

                        <!-- AI Suggestions Card -->
                        <div class="card antigaspi-ai-card">
                            <div class="card-header">
                                <h3>ü§ñ Suggestions IA</h3>
                                <span class="badge-ai">Gemini</span>
                            </div>
                            <div class="card-content" id="antigaspi-ai-content">
                                <div class="ai-empty">
                                    <span>‚ú®</span>
                                    <p>Cliquez sur "Analyser avec IA" pour obtenir des suggestions personnalis√©es</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Right Column: Valorization Recipes -->
                    <div class="antigaspi-column antigaspi-column-wide">
                        <div class="card">
                            <div class="card-header">
                                <h3>üì¶ Recettes de Valorisation</h3>
                                <span class="badge-count" id="valorization-count">0</span>
                            </div>
                            <div class="card-content">
                                <div class="valorization-grid" id="valorization-recipes-grid">
                                    <!-- Dynamically filled -->
                                </div>
                            </div>
                        </div>

                        <!-- Statistics -->
                        <div class="antigaspi-stats-grid">
                            <div class="stat-card antigaspi-stat-card">
                                <div class="stat-icon green">üåç</div>
                                <div class="stat-content">
                                    <span class="stat-value" id="stat-co2-total">0 kg</span>
                                    <span class="stat-label">CO‚ÇÇ √©vit√© potentiel</span>
                                </div>
                            </div>
                            <div class="stat-card antigaspi-stat-card">
                                <div class="stat-icon yellow">üí∞</div>
                                <div class="stat-content">
                                    <span class="stat-value" id="stat-economie-total">0 ‚Ç¨</span>
                                    <span class="stat-label">√âconomies estim√©es</span>
                                </div>
                            </div>
                            <div class="stat-card antigaspi-stat-card">
                                <div class="stat-icon purple">üìä</div>
                                <div class="stat-content">
                                    <span class="stat-value" id="stat-waste-total">0 g</span>
                                    <span class="stat-label">D√©chets valorisables</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Valorization Recipe Modal -->
            <div class="modal" id="valorization-modal">
                <div class="modal-content modal-small">
                    <div class="modal-header">
                        <h2 id="valorization-modal-title">Ajouter au Planning</h2>
                        <button class="modal-close" onclick="closeValorizationModal()">&times;</button>
                    </div>
                    <div class="modal-body">
                        <p id="valorization-modal-desc"></p>
                        <div class="form-group">
                            <label>Jour</label>
                            <select id="valorization-day">
                                <option value="0">Lundi</option>
                                <option value="1">Mardi</option>
                                <option value="2">Mercredi</option>
                                <option value="3">Jeudi</option>
                                <option value="4">Vendredi</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Type de plat</label>
                            <select id="valorization-type">
                                <option value="entree">Entr√©e</option>
                                <option value="plat_principal">Plat Principal</option>
                                <option value="garniture">Garniture</option>
                                <option value="dessert">Dessert</option>
                            </select>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-outline" onclick="closeValorizationModal()">Annuler</button>
                        <button class="btn btn-primary" onclick="confirmAddValorization()">
                            <span>‚úì</span> Ajouter au Planning
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="app.js?v=2"></script>
</body>

</html>